package com.sqlparse;

import cn.hutool.json.JSONUtil;
import com.sqlparse.model.ModelAllInfo;
import com.sqlparse.model.Operators;

import java.util.List;
import java.util.stream.Collectors;

/**
 * @Auther: huangzhigao
 * @Date: 2020/6/30
 * @Description:
 */
public class ModelJson {
    public static void main(String[] args) {
        String json = "{\"modelName\":\"模型名称\",\"modelId\":-1,\"operators\":[{\"schema\":{\"outputSchema\":[],\"inputSchema\":{\"left\":[]}},\"baseInfo\":{\"output\":-1,\"input\":1,\"incoLogo\":\"/inco/operator_unique.png\"},\"displayName\":\"数据去重\",\"location\":{\"x\":0,\"y\":0,\"from\":[],\"to\":[]},\"operatorType\":\"OPERATOR_UNIQUE\",\"operatorGroup\":\"SINGLE_TABLE\",\"operatorName\":\"\",\"props\":[{\"inputType\":\"TEXT\",\"propValue\":\"转换名称1\",\"propName\":\"转换名称\",\"desc\":{\"required\":true,\"maxLength\":50}},{\"propDef\":\"unique_field\",\"inputType\":\"MULTISELECT\",\"propValue\":\"[]\",\"propName\":\"去重字段\",\"desc\":{\"multipleLimit\":0,\"required\":true}},{\"propDef\":\"unique_rule\",\"inputType\":\"DROP_LIST\",\"propValue\":\"[{\\\"field\\\":\\\"\\\",\\\"rule\\\":\\\"\\\"}]\",\"propName\":\"去重规则\",\"desc\":{\"components\":[{\"values\":[{\"fieldName\":\"MAX\",\"fieldCnName\":\"最大MAX\"},{\"fieldName\":\"MIN\",\"fieldCnName\":\"最小MIN\"}],\"inputType\":\"SELECT\",\"propValue\":\"\",\"span\":10},{\"values\":[],\"inputType\":\"SELECT\",\"propValue\":\"\",\"span\":10}]}}]},{\"schema\":{\"outputSchema\":[],\"inputSchema\":{\"left\":[]}},\"baseInfo\":{\"output\":-1,\"input\":1,\"incoLogo\":\"/inco/operator_sort.png\"},\"displayName\":\"数据排序\",\"location\":{\"x\":0,\"y\":0,\"from\":[],\"to\":[]},\"operatorType\":\"OPERATOR_SORT\",\"operatorGroup\":\"SINGLE_TABLE\",\"operatorName\":\"\",\"props\":[{\"inputType\":\"TEXT\",\"propValue\":\"转换名称1\",\"propName\":\"转换名称\",\"desc\":{\"required\":true,\"maxLength\":50}},{\"propDef\":\"sort_field\",\"inputType\":\"MULTISELECT\",\"propValue\":\"[]\",\"propName\":\"排序字段\",\"desc\":{\"multipleLimit\":0,\"required\":true}},{\"propDef\":\"sort_rule\",\"inputType\":\"SELECT\",\"propValue\":\"\",\"propName\":\"排序规则\",\"desc\":{\"values\":[{\"fieldName\":\"ASC\",\"fieldCnName\":\"升\"},{\"fieldName\":\"DESC\",\"fieldCnName\":\"降\"}],\"required\":true}}]},{\"schema\":{\"outputSchema\":[],\"inputSchema\":{\"left\":[]}},\"baseInfo\":{\"output\":-1,\"input\":1,\"incoLogo\":\"/inco/operator_aggregation.png\"},\"displayName\":\"数据聚合\",\"location\":{\"x\":0,\"y\":0,\"from\":[],\"to\":[]},\"operatorType\":\"OPERATOR_AGGREGATION\",\"operatorGroup\":\"SINGLE_TABLE\",\"operatorName\":\"\",\"props\":[{\"inputType\":\"TEXT\",\"propValue\":\"转换名称1\",\"propName\":\"转换名称\",\"desc\":{\"required\":true,\"maxLength\":50}},{\"propDef\":\"group_field\",\"inputType\":\"MULTISELECT\",\"propValue\":\"[]\",\"propName\":\"分组字段\",\"desc\":{\"multipleLimit\":5,\"required\":true}},{\"propDef\":\"group_func\",\"inputType\":\"DIALOG_SCRIPT\",\"propValue\":\"[{\\\"func\\\":\\\"\\\",\\\"origin\\\":\\\"\\\",\\\"target\\\":\\\"\\\"}]\",\"propName\":\"值\",\"desc\":{\"components\":[[{\"values\":[{\"fieldName\":\"AVG\",\"fieldCnName\":\"平均值:AVG()\"},{\"fieldName\":\"SUM\",\"fieldCnName\":\"求和:SUM()\"},{\"fieldName\":\"COUNT\",\"fieldCnName\":\"计数:COUNT()\"},{\"fieldName\":\"MAX\",\"fieldCnName\":\"最大:MAX()\"},{\"fieldName\":\"MIN\",\"fieldCnName\":\"最小:MIN()\"},{\"fieldName\":\"CONNECT\",\"fieldCnName\":\"拼接:CONNECT()\"}],\"inputType\":\"SELECT\",\"placeholder\":\"聚合函数选择\",\"propValue\":\"\",\"span\":5},{\"values\":[],\"inputType\":\"SELECT\",\"placeholder\":\"聚合字段选择\",\"propValue\":\"\",\"span\":4},{\"inputType\":\"TEXT\",\"placeholder\":\"中文名称\",\"propValue\":\"\",\"span\":4},{\"inputType\":\"TEXT\",\"placeholder\":\"英文标识\",\"propValue\":\"\",\"span\":4},{\"inputType\":\"TEXT\",\"placeholder\":\"分隔符\",\"propValue\":\"\",\"span\":4,\"desc\":{\"name\":\"fgf\",\"maxLength\":4,\"isShow\":false}},{\"deleteClass\":\"DaaS_Tool iconjianqu\",\"inputType\":\"BUTTONADD_DELETE\",\"addClass\":\"DaaS_Tool icontianjia\",\"status\":false,\"span\":2}]],\"event\":\"ADD_DELETE\",\"required\":true}}]},{\"schema\":{\"outputSchema\":[],\"inputSchema\":{\"left\":[]}},\"baseInfo\":{\"output\":-1,\"input\":1,\"incoLogo\":\"/inco/operator_filter.png\"},\"displayName\":\"数据过滤\",\"location\":{\"x\":0,\"y\":0,\"from\":[],\"to\":[]},\"operatorType\":\"OPERATOR_FILTER\",\"operatorGroup\":\"SINGLE_TABLE\",\"operatorName\":\"\",\"props\":[{\"inputType\":\"TEXT\",\"propValue\":\"转换名称1\",\"propName\":\"转换名称\",\"desc\":{\"required\":true,\"maxLength\":50}},{\"inputType\":\"DIALOG_SCRIPT\",\"propValue\":\"\",\"propName\":\"过滤规则\",\"desc\":{\"components\":[[{\"propDef\":\"filter_rule\",\"inputType\":\"TEXT\",\"disabled\":true,\"propValue\":\"\",\"span\":10},{\"inputType\":\"BUTTONEDIT\",\"iconClass\":\"DaaS_Tool iconxiugaibianji\",\"span\":2},{\"deleteClass\":\"DaaS_Tool iconjianqu\",\"inputType\":\"BUTTONADD_DELETE\",\"addClass\":\"DaaS_Tool icontianjia\",\"status\":false,\"span\":2}]],\"event\":\"ADD_RULE\",\"required\":true}}]},{\"schema\":{\"outputSchema\":[],\"inputSchema\":{\"left\":[]}},\"baseInfo\":{\"output\":-1,\"input\":1,\"incoLogo\":\"/inco/operator_col_add.png\"},\"displayName\":\"添加字段\",\"location\":{\"x\":0,\"y\":0,\"from\":[],\"to\":[]},\"operatorType\":\"OPERATOR_COL_ADD\",\"operatorGroup\":\"SINGLE_TABLE\",\"operatorName\":\"\",\"props\":[{\"inputType\":\"TEXT\",\"propValue\":\"转换名称1\",\"propName\":\"转换名称\",\"desc\":{\"required\":true,\"maxLength\":50}},{\"propDef\":\"field_add\",\"inputType\":\"TEBLE_SELECT\",\"propValue\":\"[{\\\"fieldName\\\":\\\"\\\"}]\",\"propName\":\"字段添加\",\"desc\":{\"values\":[{\"fieldName\":\"string\",\"fieldCnName\":\"string\"},{\"fieldName\":\"boolen\",\"fieldCnName\":\"boolen\"}],\"event\":\"ADD\",\"propValue\":[],\"propKey\":[{\"prop\":\"fieldCnName\",\"inputType\":\"TEXT\",\"id\":1,\"label\":\"字段中文名称\"},{\"prop\":\"fieldName\",\"inputType\":\"TEXT\",\"id\":2,\"label\":\"字段英文名称\"},{\"prop\":\"fieldType\",\"inputType\":\"SELECT\",\"id\":3,\"label\":\"字段类型\"},{\"prop\":\"fieldLength\",\"inputType\":\"TEXT\",\"id\":4,\"label\":\"字段长度\"},{\"prop\":\"rule\",\"inputType\":\"DIALOG\",\"id\":5,\"label\":\"添加规则\"}]}}]},{\"schema\":{\"outputSchema\":[],\"inputSchema\":{\"left\":[]}},\"baseInfo\":{\"output\":-1,\"input\":0,\"incoLogo\":\"/inco/operator_source.png\"},\"hideValue\":{\"table_id\":\"-1\"},\"displayName\":\"输入源\",\"location\":{\"x\":0,\"y\":0,\"from\":[],\"to\":[]},\"operatorType\":\"SOURCE\",\"operatorGroup\":\"SOURCE\",\"operatorName\":\"\",\"props\":[]},{\"schema\":{\"outputSchema\":[],\"inputSchema\":{\"left\":[]}},\"baseInfo\":{\"output\":0,\"input\":1,\"incoLogo\":\"/inco/operator_sink.png\"},\"hideValue\":{\"db_type\":\"\",\"db_name\":\"\",\"out_type\":\"\",\"business_type\":\"\",\"age_date\":\"\",\"table_cnName\":\"\",\"table_id\":\"\",\"data_source_2\":\"\",\"table_name\":\"\",\"data_source_1\":\"\",\"desc\":\"\"},\"displayName\":\"输出源\",\"location\":{\"x\":0,\"y\":0,\"from\":[],\"to\":[]},\"operatorType\":\"SINK\",\"operatorGroup\":\"SINK\",\"operatorName\":\"\",\"props\":[]},{\"schema\":{\"outputSchema\":[],\"inputSchema\":{\"left\":[]}},\"baseInfo\":{\"output\":-1,\"input\":1,\"incoLogo\":\"/inco/operator_col_select.png\"},\"displayName\":\"选择列\",\"location\":{\"x\":0,\"y\":0,\"from\":[],\"to\":[]},\"operatorType\":\"OPERATOR_COL_SELECT\",\"operatorGroup\":\"SINGLE_TABLE\",\"operatorName\":\"\",\"props\":[{\"inputType\":\"TEXT\",\"propValue\":\"转换名称1\",\"propName\":\"转换名称\",\"desc\":{\"required\":true,\"maxLength\":50}},{\"propDef\":\"field_select\",\"inputType\":\"TEBLE_SELECT\",\"propValue\":\"[{\\\"origin\\\":\\\"originField\\\",\\\"target\\\":\\\"field\\\"}]\",\"propName\":\"字段选择\",\"desc\":{\"event\":\"SELECT\",\"propValue\":[],\"propKey\":[{\"prop\":\"fieldCnName\",\"id\":1,\"label\":\"字段中文名称\"},{\"prop\":\"fieldName\",\"id\":2,\"label\":\"字段英文名称\"},{\"prop\":\"fieldType\",\"id\":3,\"label\":\"字段类型\"},{\"prop\":\"fieldLength\",\"id\":4,\"label\":\"字段长度\"}]}}]}],\"runType\":-1,\"runCorn\":\"\",\"modelLable\":\"发生放大\",\"modelDesc\":\"发撒打发\"}";
        ModelAllInfo modelAllInfo = JSONUtil.toBean(json, ModelAllInfo.class);
        List<Operators> sources= modelAllInfo.getOperators().stream().filter(operator -> operator.getOperatorType().equalsIgnoreCase("SOURCE")&&"2".equals(operator.getHideValue().get("dataSourceType"))).collect(Collectors.toList());
        List<Operators> sinks= modelAllInfo.getOperators().stream().filter(operator -> operator.getOperatorType().equalsIgnoreCase("SINKS")).collect(Collectors.toList());
//        sources.stream().filter(source->source.getHideValue());
    }
}
